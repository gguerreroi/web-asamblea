<% function rowAsistencia(data){ %>
    <tr class="border-4 border-gray-200 text-leftr">
        <td></td>
        <td></td>
        <td><span class="text-center ml-2 font-semibold">Gustavo</span></td>
        <td class=" py-2">
            <span>Masculino</span>
        </td>
        <td class=" py-2">
            <span>55443355</span>
        </td>
    </tr>
 <% } %>
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Lista de Asistencia</title>
    <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/a81368914c.js"></script>
</head>
<body>
<div class="bg-white p-2 w-screen h-40 ">
    <div>
        <img src="/images/logo-micoope.png" alt="Logo MICOOPE" class="float-left w-32 p-2">
    </div>
    <div class="text-center">
        <h1 class="text-4xl text-blue-900 font-bold"><%- app_title %> </h1>
        <p class="text-base font-semibold text-green-600 "><%- app_subtitle %></p>
        <br>
        <p class="text-base font-semibold ">Listado de Asistencia</p>
        <br>
        <div class="float-right p-2 mr-2 " id="btnActions">
            <button class="bg-green-600 hover:bg-green-700 focus:outline-none text-white p-3 rounded-lg"
                    onclick="exportTableToExcel('tbasistencia', 'ListadoAsistencia')"><i class="fas fa-file-excel"></i>
                Excel
            </button>
            <button class="bg-blue-600 hover:bg-blue-700 focus:outline-none text-white p-3 rounded-lg"
                    onclick="exportTableToWord('tbasistencia', 'ListadoAsistencia')"><i class="fas fa-file-word"></i>
                Word
            </button>
            <button class="bg-gray-400 hover:bg-gray-500 hover:outline-black text-black p-3 rounded-lg"
                    onclick="sendPrint()"
            ><i class="fas fa-print"></i> Impresora
            </button>
        </div>
        <br>
    </div>
</div>

<div>
    <table class="min-w-full table-auto" id="tbasistencia">
        <thead class="">
        <tr class="bg-gray-800 text-gray-300 text-center">
            <th>FECHA Y HORA</th>
            <th>CODIGO ASOCIADO</th>
            <th>NOMBRE ASOCIADO</th>
            <th>GENERO</th>
            <th>TELEFONO</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>
<script
        src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
        crossorigin="anonymous"></script>

<script>
    function sendPrint() {
        $("#btnActions").hide()
        window.print()
        $("#btnActions").show()
    }

    function exportTableToExcel(tableID, filename = '') {
        var downloadLink;
        var dataType = 'application/vnd.ms-excel';
        var tableSelect = document.getElementById(tableID);
        var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');

        // Specify file name
        filename = filename ? filename + '.xls' : 'excel_data.xls';

        // Create download link element
        downloadLink = document.createElement("a");

        document.body.appendChild(downloadLink);

        if (navigator.msSaveOrOpenBlob) {
            var blob = new Blob(['\ufeff', tableHTML], {
                type: dataType
            });
            navigator.msSaveOrOpenBlob(blob, filename);
        } else {
            // Create a link to the file
            downloadLink.href = 'data:' + dataType + ', ' + tableHTML;

            // Setting the file name
            downloadLink.download = filename;

            //triggering the function
            downloadLink.click();
        }
    }

    function exportTableToWord(tableID, filename = '') {
        var downloadLink;
        var dataType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document; charset=utf-8';
        var tableSelect = document.getElementById(tableID);
        var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');

        // Specify file name
        filename = filename ? filename + '.doc' : 'word_data.doc';

        // Create download link element
        downloadLink = document.createElement("a");

        document.body.appendChild(downloadLink);

        if (navigator.msSaveOrOpenBlob) {
            var blob = new Blob(['\ufeff', tableHTML], {
                type: dataType
            });
            navigator.msSaveOrOpenBlob(blob, filename);
        } else {
            // Create a link to the file
            downloadLink.href = 'data:' + dataType + ', ' + tableHTML;

            // Setting the file name
            downloadLink.download = filename;

            //triggering the function
            downloadLink.click();
        }
    }
</script>
</body>
</html>
